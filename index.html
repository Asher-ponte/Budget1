<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FinTrack Pro</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.22.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
const { useState, useEffect } = React;

// Helper functions for localStorage
const STORAGE_KEY = "fintrackpro_data";
const VIEW_KEY = "fintrackpro_view";
function saveToStorage(data) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
}
function loadFromStorage() {
  const data = localStorage.getItem(STORAGE_KEY);
  return data ? JSON.parse(data) : null;
}
function saveView(view) {
  localStorage.setItem(VIEW_KEY, view);
}
function loadView() {
  return localStorage.getItem(VIEW_KEY) || "dashboard";
}

// --- API helpers for Node.js backend ---
async function loadFromAPI(type) {
  const res = await fetch(`http://localhost:4000/api/${type}`);
  return await res.json();
}

async function saveToAPI(type, data) {
  await fetch(`http://localhost:4000/api/${type}`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  });
}

// Months for budget tracker
const MONTHS = [
  "January", "February", "March", "April", "May", "June",
  "July", "August", "September", "October", "November", "December"
];

const App = () => {
  // State for navigation
  const [view, setView] = useState(loadView());

  // State for financial data
  const [totalBalance, setTotalBalance] = useState(24562.00);
  const [monthlyIncome, setMonthlyIncome] = useState(8350.00);
  const [monthlyExpenses, setMonthlyExpenses] = useState(5240.00);
  const [savingsRate, setSavingsRate] = useState(37.2);
  const [transactions, setTransactions] = useState([]);
  const [showTransactionForm, setShowTransactionForm] = useState(false);

  // State for new transaction form
  const [transactionType, setTransactionType] = useState('income');
  const [amount, setAmount] = useState('');
  const [category, setCategory] = useState('');
  const [date, setDate] = useState(() => new Date().toISOString().slice(0, 10));
  const [transactionMonth, setTransactionMonth] = useState(MONTHS[new Date().getMonth()]);
  const [transactionCard, setTransactionCard] = useState('');
  const [savingAccount, setSavingAccount] = useState('');

  // Edit transaction state
  const [editIndex, setEditIndex] = useState(null);

  // Credit card state
  const [creditCards, setCreditCards] = useState([]);
  const [ccName, setCcName] = useState('');
  const [ccDate, setCcDate] = useState('');
  const [ccStatus, setCcStatus] = useState('Paid');
  const [ccBalance, setCcBalance] = useState('');

  // Budget tracker state (multiple allocations per month)
  const [budgets, setBudgets] = useState([]); // [{month, description, amount}]
  const [showBudgetForm, setShowBudgetForm] = useState(false);
  const [budgetMonth, setBudgetMonth] = useState(MONTHS[0]);
  const [budgetDescription, setBudgetDescription] = useState('');
  const [budgetAmount, setBudgetAmount] = useState('');
  const [editBudgetIndex, setEditBudgetIndex] = useState(null);

  // State for yearly saving target
  const [savingTarget, setSavingTarget] = useState(10000); // Default target, can be changed

  // Get current month string (e.g., "May")
  const currentMonth = MONTHS[new Date().getMonth()];

  // Calculate totals from transactions
  const totalIncome = transactions
    .filter(t => t.type === "income")
    .reduce((sum, t) => sum + parseFloat(t.amount), 0);

  const totalExpenses = transactions
    .filter(t => t.type === "expense")
    .reduce((sum, t) => sum + parseFloat(t.amount), 0);

  const totalSavings = transactions
    .filter(t => t.type === "saving")
    .reduce((sum, t) => sum + parseFloat(t.amount), 0);

  const savingsLeft = Math.max(savingTarget - totalSavings, 0);
  const savingsPercent = savingTarget > 0 ? Math.round((totalSavings / savingTarget) * 100) : 0;

  // Running balance: income - expenses - savings
  const runningBalance = totalIncome - totalExpenses - totalSavings;

  // Current month expenses
  const currentMonthExpenses = transactions
    .filter(t => t.type === "expense" && t.month === currentMonth)
    .reduce((sum, t) => sum + parseFloat(t.amount), 0);

  // Current month savings
  const currentMonthSavings = transactions
    .filter(t => t.type === "saving" && t.month === currentMonth)
    .reduce((sum, t) => sum + parseFloat(t.amount), 0);

  // Load from localStorage on mount
  useEffect(() => {
    const data = loadFromStorage();
    if (data) {
      setTotalBalance(data.totalBalance);
      setMonthlyIncome(data.monthlyIncome);
      setMonthlyExpenses(data.monthlyExpenses);
      setSavingsRate(data.savingsRate);
      setTransactions(data.transactions || []);
      setCreditCards(data.creditCards || []);
      setBudgets(data.budgets || []);
    }
    setView(loadView());
  }, []);

  // Load from API on mount
  useEffect(() => {
    loadFromAPI('transactions').then(data => setTransactions(data || []));
    loadFromAPI('budgets').then(data => setBudgets(data || []));
    loadFromAPI('creditCards').then(data => setCreditCards(data || []));
  }, []);

  // Save to localStorage on data change
  useEffect(() => {
    saveToStorage({
      totalBalance,
      monthlyIncome,
      monthlyExpenses,
      savingsRate,
      transactions,
      creditCards,
      budgets,
    });
  }, [totalBalance, monthlyIncome, monthlyExpenses, savingsRate, transactions, creditCards, budgets]);

  // Save to API when data changes
  useEffect(() => {
    saveToAPI('transactions', transactions);
  }, [transactions]);

  useEffect(() => {
    saveToAPI('budgets', budgets);
  }, [budgets]);

  useEffect(() => {
    saveToAPI('creditCards', creditCards);
  }, [creditCards]);

  // Save view to localStorage
  useEffect(() => {
    saveView(view);
  }, [view]);

  // Handle adding or editing a transaction
  const handleAddOrEditTransaction = (e) => {
    e.preventDefault();
    const amountValue = parseFloat(amount);
    if (isNaN(amountValue) || amountValue <= 0) return;

    let updatedTransactions = [...transactions];
    let newIncome = monthlyIncome;
    let newExpenses = monthlyExpenses;
    let newBalance = totalBalance;

    if (editIndex !== null) {
      // Editing: revert old transaction effect
      const old = transactions[editIndex];
      if (old.type === "income") {
        newIncome -= old.amount;
        newBalance -= old.amount;
      } else {
        newExpenses -= old.amount;
        newBalance += old.amount;
      }
      // Update transaction
      updatedTransactions[editIndex] = {
        type: transactionType,
        amount: amountValue,
        category,
        date,
        month: transactionMonth,
        card: transactionCard,
        ...(transactionType === "saving" ? { account: savingAccount } : {})
      };
    } else {
      // Adding new
      updatedTransactions.push({
        type: transactionType,
        amount: amountValue,
        category,
        date,
        month: transactionMonth,
        card: transactionCard,
        ...(transactionType === "saving" ? { account: savingAccount } : {})
      });
    }

    // Apply new transaction effect
    if (transactionType === 'income') {
      newIncome += amountValue;
      newBalance += amountValue;
    } else {
      newExpenses += amountValue;
      newBalance -= amountValue;
    }

    setTransactions(updatedTransactions);
    setMonthlyIncome(newIncome);
    setMonthlyExpenses(newExpenses);
    setTotalBalance(newBalance);

    // Update savings rate
    const newSavingsRate = ((newIncome - newExpenses) / newIncome) * 100;
    setSavingsRate(newSavingsRate.toFixed(1));

    // Reset form
    setAmount('');
    setCategory('');
    setDate(new Date().toISOString().slice(0, 10));
    setTransactionMonth(MONTHS[new Date().getMonth()]);
    setTransactionCard('');
    setSavingAccount('');
    setShowTransactionForm(false);
    setEditIndex(null);
  };

  // Edit handler for transactions
  const handleEditTransaction = (idx) => {
    const t = transactions[idx];
    setTransactionType(t.type);
    setAmount(t.amount);
    setCategory(t.category);
    setDate(t.date);
    setTransactionMonth(t.month || MONTHS[new Date().getMonth()]);
    setTransactionCard(t.card || '');
    setSavingAccount(t.account || '');
    setShowTransactionForm(true);
    setEditIndex(idx);
    setView("reports");
  };

  // Delete handler for transactions
  const handleDeleteTransaction = (idx) => {
    if (window.confirm("Delete this transaction?")) {
      setTransactions(transactions.filter((_, i) => i !== idx));
    }
  };

  // Sidebar navigation handler
  const handleNav = (nav) => {
    setView(nav);
    setShowTransactionForm(false);
    setEditIndex(null);
    setShowBudgetForm(false);
    setEditBudgetIndex(null);
  };

  // Handle add credit card
  const handleAddCreditCard = (e) => {
    e.preventDefault();
    if (!ccName || !ccDate || !ccStatus || ccBalance === '') return;
    setCreditCards([
      ...creditCards,
      { name: ccName, date: ccDate, status: ccStatus, balance: parseFloat(ccBalance) }
    ]);
    setCcName('');
    setCcDate('');
    setCcStatus('Paid');
    setCcBalance('');
  };

  // Handle add/edit budget allocation
  const handleAddOrEditBudget = (e) => {
    e.preventDefault();
    if (!budgetDescription || !budgetAmount || isNaN(parseFloat(budgetAmount))) return;
    const newBudget = {
      month: budgetMonth,
      description: budgetDescription,
      amount: parseFloat(budgetAmount)
    };
    let updated = [...budgets];
    if (editBudgetIndex !== null) {
      updated[editBudgetIndex] = newBudget;
    } else {
      updated.push(newBudget);
    }
    setBudgets(updated);
    setShowBudgetForm(false);
    setBudgetDescription('');
    setBudgetAmount('');
    setBudgetMonth(MONTHS[0]);
    setEditBudgetIndex(null);
  };

  // Edit handler for budget
  const handleEditBudget = (idx) => {
    const b = budgets[idx];
    setBudgetMonth(b.month);
    setBudgetDescription(b.description);
    setBudgetAmount(b.amount);
    setShowBudgetForm(true);
    setEditBudgetIndex(idx);
  };

  // Delete handler for budget
  const handleDeleteBudget = (idx) => {
    if (window.confirm("Delete this budget allocation?")) {
      setBudgets(budgets.filter((_, i) => i !== idx));
    }
  };

  // Calculate actual expenses per month (sum of all expense transactions for that month)
  const actualExpensesPerMonth = MONTHS.map(month =>
    transactions
      .filter(t => t.type === "expense" && t.month === month)
      .reduce((sum, t) => sum + parseFloat(t.amount), 0)
  );

  // Bar graph for dashboard (simple SVG)
  function BarGraph() {
    // For each month, sum budget and actual
    const budgetPerMonth = MONTHS.map(month =>
      budgets.filter(b => b.month === month).reduce((sum, b) => sum + parseFloat(b.amount), 0)
    );
    const max = Math.max(...budgetPerMonth, ...actualExpensesPerMonth, 1);
    return (
      <svg width="100%" height="180">
        {MONTHS.map((month, i) => {
          const budgetH = (budgetPerMonth[i] / max) * 120;
          const actualH = (actualExpensesPerMonth[i] / max) * 120;
          return (
            <g key={month}>
              {/* Budget bar */}
              <rect x={i * 40 + 10} y={150 - budgetH} width="12" height={budgetH} fill="#6366f1" />
              {/* Actual bar */}
              <rect x={i * 40 + 25} y={150 - actualH} width="12" height={actualH} fill="#f59e42" />
              {/* Month label */}
              <text x={i * 40 + 16} y={165} fontSize="10" fill="#333" transform={`rotate(30 ${i * 40 + 16},165)`}>{month.slice(0,3)}</text>
            </g>
          );
        })}
        {/* Legend */}
        <rect x={10} y={170} width="12" height="8" fill="#6366f1" />
        <text x={25} y={178} fontSize="10">Budget</text>
        <rect x={70} y={170} width="12" height="8" fill="#f59e42" />
        <text x={85} y={178} fontSize="10">Actual</text>
      </svg>
    );
  }

  // Budget Left Gauge for Current Month (with red color if over budget)
  function BudgetLeftGauge() {
    const monthBudget = budgets
      .filter(b => b.month === currentMonth)
      .reduce((sum, b) => sum + parseFloat(b.amount), 0);
    const monthExpenses = transactions
      .filter(t => t.type === "expense" && t.month === currentMonth)
      .reduce((sum, t) => sum + parseFloat(t.amount), 0);

    const left = monthBudget - monthExpenses;
    const percent = monthBudget > 0
      ? Math.round((Math.max(left, 0) / monthBudget) * 100)
      : 0;
    const overPercent = monthBudget > 0 && left < 0
      ? Math.min(Math.abs(left) / monthBudget, 1) * 100
      : 0;

    // Gauge SVG: green if within budget, red for over budget
    return (
      <div className="bg-white p-4 rounded-lg shadow flex flex-col items-center justify-center" style={{minWidth:180}}>
        <h2 className="text-lg font-semibold mb-2">Budget Left</h2>
        <svg width="120" height="70">
          {/* Background arc */}
          <path
            d="M10,60 A50,50 0 0,1 110,60"
            fill="none"
            stroke="#e5e7eb"
            strokeWidth="14"
          />
          {/* Green arc for remaining budget */}
          {left >= 0 && (
            <path
              d="M10,60 A50,50 0 0,1 110,60"
              fill="none"
              stroke="#22c55e"
              strokeWidth="14"
              strokeDasharray={`${(percent/100)*157},157`}
            />
          )}
          {/* Red arc for over budget */}
          {left < 0 && (
            <path
              d="M10,60 A50,50 0 0,1 110,60"
              fill="none"
              stroke="#ef4444"
              strokeWidth="14"
              strokeDasharray={`157,157`}
            />
          )}
          <text x="60" y="50" textAnchor="middle" fontSize="22" fill={left < 0 ? "#ef4444" : "#222"}>
            {left >= 0 ? `${percent}%` : "Over"}
          </text>
        </svg>
        <div className="flex justify-between w-full mt-2 text-xs text-gray-500">
          <span>‚Ç±0</span>
          <span>‚Ç±{monthBudget.toLocaleString()}</span>
        </div>
        <div className={`mt-1 text-sm ${left < 0 ? "text-red-600" : "text-gray-700"}`}>
          {left >= 0
            ? `‚Ç±${left.toLocaleString()} left`
            : `‚Ç±${Math.abs(left).toLocaleString()} over`}
        </div>
      </div>
    );
  }

  // Target Saving Circle Gauge
  function TargetSavingGauge() {
    return (
      <div className="bg-white p-4 rounded-lg shadow flex flex-col items-center justify-center" style={{minWidth:180}}>
        <h2 className="text-lg font-semibold mb-2">Target Saving</h2>
        <svg width="120" height="120">
          <circle
            cx="60"
            cy="60"
            r="50"
            fill="none"
            stroke="#e5e7eb"
            strokeWidth="14"
          />
          <circle
            cx="60"
            cy="60"
            r="50"
            fill="none"
            stroke="#22c55e"
            strokeWidth="14"
            strokeDasharray={`${(savingsPercent/100)*314},314`}
            strokeLinecap="round"
            transform="rotate(-90 60 60)"
          />
          <text x="60" y="68" textAnchor="middle" fontSize="22" fill="#222">{savingsPercent}%</text>
        </svg>
        <div className="flex justify-between w-full mt-2 text-xs text-gray-500">
          <span>‚Ç±{totalSavings.toLocaleString()}</span>
          <span>‚Ç±{savingTarget.toLocaleString()}</span>
        </div>
        <div className="mt-1 text-sm text-gray-700">‚Ç±{savingsLeft.toLocaleString()} left</div>
      </div>
    );
  }

  // Cash Flow Chart (Income, Expenses, Savings per month)
  function CashFlowChart() {
    const income = MONTHS.map(month =>
      transactions.filter(t => t.type === "income" && t.month === month)
        .reduce((sum, t) => sum + parseFloat(t.amount), 0)
    );
    const expenses = MONTHS.map(month =>
      transactions.filter(t => t.type === "expense" && t.month === month)
        .reduce((sum, t) => sum + parseFloat(t.amount), 0)
    );
    const savings = MONTHS.map(month =>
      transactions.filter(t => t.type === "saving" && t.month === month)
        .reduce((sum, t) => sum + parseFloat(t.amount), 0)
    );
    const max = Math.max(...income, ...expenses, ...savings, 1);

    return (
      <div className="bg-white p-4 rounded-lg shadow flex-1">
        <h2 className="text-lg font-semibold mb-2">Cash Flow</h2>
        <svg width="100%" height="140" viewBox="0 0 480 140">
          {/* Lines */}
          {[income, expenses, savings].map((arr, idx) => {
            const color = ["#22c55e", "#ef4444", "#f59e42"][idx];
            return (
              <polyline
                key={idx}
                fill="none"
                stroke={color}
                strokeWidth="3"
                points={
                  arr.map((v, i) =>
                    `${i * 40 + 30},${120 - (v / max) * 100 + 10}`
                  ).join(" ")
                }
              />
            );
          })}
          {/* Dots */}
          {[income, expenses, savings].map((arr, idx) => {
            const color = ["#22c55e", "#ef4444", "#f59e42"][idx];
            return arr.map((v, i) => (
              <circle
                key={idx + "-" + i}
                cx={i * 40 + 30}
                cy={120 - (v / max) * 100 + 10}
                r="4"
                fill={color}
              />
            ));
          })}
          {/* Month labels */}
          {MONTHS.map((m, i) => (
            <text key={m} x={i * 40 + 30} y={135} fontSize="10" textAnchor="middle" fill="#555">{m.slice(0,3)}</text>
          ))}
        </svg>
        <div className="flex gap-4 mt-2 text-xs">
          <span className="flex items-center"><span className="w-3 h-3 rounded-full bg-green-500 mr-1 inline-block"></span>Income</span>
          <span className="flex items-center"><span className="w-3 h-3 rounded-full bg-red-500 mr-1 inline-block"></span>Expenses</span>
          <span className="flex items-center"><span className="w-3 h-3 rounded-full bg-orange-400 mr-1 inline-block"></span>Savings</span>
        </div>
      </div>
    );
  }

  // Top 5 Expense Categories
  function TopExpenseCategories() {
    // Aggregate by category
    const categoryTotals = {};
    transactions.forEach(t => {
      if (t.type === "expense" && t.category) {
        categoryTotals[t.category] = (categoryTotals[t.category] || 0) + parseFloat(t.amount);
      }
    });
    const sorted = Object.entries(categoryTotals)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 5);

    const max = sorted.length > 0 ? sorted[0][1] : 1;

    return (
      <div className="bg-white p-4 rounded-lg shadow flex-1">
        <h2 className="text-lg font-semibold mb-2">Top 5 Expense Categories</h2>
        {sorted.length === 0 ? (
          <p className="text-gray-500">No expense data.</p>
        ) : (
          <div>
            {sorted.map(([cat, amt], i) => (
              <div key={cat} className="mb-2">
                <div className="flex justify-between">
                  <span className="font-medium">{cat}</span>
                  <span className="font-mono">‚Ç±{amt.toLocaleString(undefined, {maximumFractionDigits:2})}</span>
                </div>
                <div className="h-3 bg-gray-200 rounded">
                  <div
                    className="h-3 rounded bg-red-400"
                    style={{ width: `${(amt / max) * 100}%` }}
                  ></div>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    );
  }

  // Savings Location (list of savings by account)
  function SavingsLocation() {
    // Aggregate savings by account
    const accountTotals = {};
    transactions.forEach(t => {
      if (t.type === "saving" && t.account) {
        accountTotals[t.account] = (accountTotals[t.account] || 0) + parseFloat(t.amount);
      }
    });
    const sorted = Object.entries(accountTotals).sort((a, b) => b[1] - a[1]);
    return (
      <div className="bg-white p-4 rounded-lg shadow flex-1">
        <h2 className="text-lg font-semibold mb-2">Savings Location</h2>
        {sorted.length === 0 ? (
          <p className="text-gray-500">No savings data.</p>
        ) : (
          <div>
            {sorted.map(([acc, amt]) => (
              <div key={acc} className="mb-2">
                <div className="flex justify-between">
                  <span className="font-medium">{acc}</span>
                  <span className="font-mono">‚Ç±{amt.toLocaleString(undefined, {maximumFractionDigits:2})}</span>
                </div>
                <div className="h-3 bg-gray-200 rounded">
                  <div
                    className="h-3 rounded bg-green-400"
                    style={{ width: "100%" }}
                  ></div>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    );
  }

  // Sidebar links
  const sidebarLinks = [
    { key: "dashboard", label: "Dashboard", icon: "üìä" },
    { key: "budget", label: "Budget Tracker", icon: "üìà" },
    { key: "credit", label: "Credit Card Payments", icon: "üí≥" },
    { key: "reports", label: "Transaction and Reports", icon: "üìã" },
    { key: "tools", label: "Financial Tools", icon: "üõ†Ô∏è" },
  ];

  // Render different views
  function renderContent() {
    switch (view) {
      case "dashboard":
        return (
          <>
            <h1 className="text-2xl font-bold mb-4">Financial Dashboard</h1>
            {/* Dashboard Cards */}
            <div className="grid grid-cols-3 gap-4 mb-6">
              <div className="bg-white p-4 rounded-lg shadow">
                <h2 className="text-lg font-semibold">Total Balance</h2>
                <p className="text-2xl font-bold">‚Ç±{runningBalance.toFixed(2)}</p>
                <p className="text-gray-500">Running balance (Income - Expenses - Savings)</p>
              </div>
              <div className="bg-white p-4 rounded-lg shadow">
                <h2 className="text-lg font-semibold">Monthly Expenses</h2>
                <p className="text-2xl font-bold">‚Ç±{currentMonthExpenses.toFixed(2)}</p>
                <p className="text-red-500">Current Month: {currentMonth}</p>
              </div>
              <div className="bg-white p-4 rounded-lg shadow">
                <TargetSavingGauge />
              </div>
            </div>
            {/* Budget Left, Top Expenses, Savings Location */}
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
              <BudgetLeftGauge />
              <TopExpenseCategories />
              <SavingsLocation />
            </div>
            {/* Bar Graph for Budget vs Actual */}
            <div className="bg-white p-4 rounded-lg shadow mb-6">
              <h2 className="text-lg font-semibold mb-2">Budget vs Actual Expenses (Monthly)</h2>
              <BarGraph />
            </div>
            {/* Placeholder for Monthly Cash Flow and Expense Breakdown */}
            <div className="grid grid-cols-2 gap-4">
              <div className="bg-white p-4 rounded-lg shadow">
                <h2 className="text-lg font-semibold mb-4">Monthly Cash Flow</h2>
                <div className="flex space-x-2 mb-4">
                  <button className="bg-indigo-200 text-indigo-800 px-3 py-1 rounded">Monthly</button>
                  <button className="bg-gray-200 px-3 py-1 rounded">Quarterly</button>
                  <button className="bg-gray-200 px-3 py-1 rounded">Yearly</button>
                </div>
                <p className="text-gray-500">Chart placeholder</p>
              </div>
              <div className="bg-white p-4 rounded-lg shadow">
                <h2 className="text-lg font-semibold mb-4">Expense Breakdown</h2>
                <p className="text-gray-500">Chart placeholder</p>
              </div>
            </div>
          </>
        );
      case "budget":
        return (
          <div>
            <h1 className="text-2xl font-bold mb-4">Budget Tracker</h1>
            <button
              onClick={() => {
                setShowBudgetForm(true);
                setEditBudgetIndex(null);
                setBudgetMonth(MONTHS[0]);
                setBudgetDescription('');
                setBudgetAmount('');
              }}
              className="bg-indigo-600 text-white px-4 py-2 rounded mb-6"
            >
              + Add Budget Allocation
            </button>
            {/* Budget Form */}
            {showBudgetForm && (
              <div className="bg-white p-4 rounded-lg shadow mb-6">
                <h2 className="text-lg font-semibold mb-4">{editBudgetIndex !== null ? "Edit Budget Allocation" : "Add Budget Allocation"}</h2>
                <form className="flex space-x-4" onSubmit={handleAddOrEditBudget}>
                  <select
                    value={budgetMonth}
                    onChange={e => setBudgetMonth(e.target.value)}
                    className="border p-2 rounded"
                  >
                    {MONTHS.map(m => <option key={m} value={m}>{m}</option>)}
                  </select>
                  <input
                    type="text"
                    placeholder="Description"
                    value={budgetDescription}
                    onChange={e => setBudgetDescription(e.target.value)}
                    className="border p-2 rounded"
                    required
                  />
                  <input
                    type="number"
                    placeholder="Budget Amount"
                    value={budgetAmount}
                    onChange={e => setBudgetAmount(e.target.value)}
                    className="border p-2 rounded"
                    required
                  />
                  <button
                    type="submit"
                    className="bg-indigo-600 text-white px-4 py-2 rounded"
                  >
                    {editBudgetIndex !== null ? "Update" : "Save"}
                  </button>
                  <button
                    type="button"
                    onClick={() => {
                      setShowBudgetForm(false);
                      setEditBudgetIndex(null);
                      setBudgetDescription('');
                      setBudgetAmount('');
                      setBudgetMonth(MONTHS[0]);
                    }}
                    className="bg-gray-300 px-4 py-2 rounded"
                  >
                    Cancel
                  </button>
                </form>
                <div className="mt-4">
                  <label className="block text-sm font-semibold mb-1">Set Yearly Saving Target</label>
                  <input
                    type="number"
                    value={savingTarget}
                    onChange={e => setSavingTarget(Number(e.target.value))}
                    className="border p-2 rounded w-48"
                    min={0}
                  />
                </div>
              </div>
            )}
            {/* Budget Allocations Table */}
            <div className="bg-white p-4 rounded-lg shadow">
              <h2 className="text-lg font-semibold mb-4">Budget Allocations</h2>
              {budgets.length === 0 ? (
                <p className="text-gray-500">No budget allocations yet.</p>
              ) : (
                <table className="min-w-full text-sm">
                  <thead>
                    <tr>
                      <th className="px-2 py-1 border">Month</th>
                      <th className="px-2 py-1 border">Description</th>
                      <th className="px-2 py-1 border">Budget Amount</th>
                      <th className="px-2 py-1 border">Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    {budgets.map((b, idx) => (
                      <tr key={idx}>
                        <td className="px-2 py-1 border">{b.month}</td>
                        <td className="px-2 py-1 border">{b.description}</td>
                        <td className="px-2 py-1 border">‚Ç±{parseFloat(b.amount).toFixed(2)}</td>
                        <td className="px-2 py-1 border">
                          <button
                            className="text-indigo-600 underline mr-2"
                            onClick={() => handleEditBudget(idx)}
                          >
                            Edit
                          </button>
                          <button
                            className="text-red-600 underline"
                            onClick={() => handleDeleteBudget(idx)}
                          >
                            Delete
                          </button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              )}
            </div>
          </div>
        );
      case "credit":
        return (
          <div>
            <h1 className="text-2xl font-bold mb-4">Credit Card Payments</h1>
            <form className="flex space-x-4 mb-6" onSubmit={handleAddCreditCard}>
              <input
                type="text"
                placeholder="Credit Card Name"
                value={ccName}
                onChange={e => setCcName(e.target.value)}
                className="border p-2 rounded"
                required
              />
              <input
                type="date"
                placeholder="Payment Date"
                value={ccDate}
                onChange={e => setCcDate(e.target.value)}
                className="border p-2 rounded"
                required
              />
              <select
                value={ccStatus}
                onChange={e => setCcStatus(e.target.value)}
                className="border p-2 rounded"
              >
                <option value="Paid">Paid</option>
                <option value="Partial">Partial</option>
              </select>
              <input
                type="number"
                placeholder="Balance"
                value={ccBalance}
                onChange={e => setCcBalance(e.target.value)}
                className="border p-2 rounded"
                required
              />
              <button
                type="submit"
                className="bg-indigo-600 text-white px-4 py-2 rounded"
              >
                Add Card
              </button>
            </form>
            {/* Credit Card List */}
            <div className="bg-white p-4 rounded-lg shadow">
              <h2 className="text-lg font-semibold mb-4">Credit Cards</h2>
              {creditCards.length === 0 ? (
                <p className="text-gray-500">No credit cards added.</p>
              ) : (
                <table className="min-w-full text-sm">
                  <thead>
                    <tr>
                      <th className="px-2 py-1 border">Name</th>
                      <th className="px-2 py-1 border">Payment Date</th>
                      <th className="px-2 py-1 border">Status</th>
                      <th className="px-2 py-1 border">Balance</th>
                    </tr>
                  </thead>
                  <tbody>
                    {creditCards.map((c, idx) => (
                      <tr key={idx}>
                        <td className="px-2 py-1 border">{c.name}</td>
                        <td className="px-2 py-1 border">{c.date}</td>
                        <td className="px-2 py-1 border">{c.status}</td>
                        <td className="px-2 py-1 border">‚Ç±{c.balance.toFixed(2)}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              )}
            </div>
          </div>
        );
      case "reports":
        return (
          <div>
            <h1 className="text-2xl font-bold mb-4">Transaction and Reports</h1>
            <button
              onClick={() => {
                setShowTransactionForm(true);
                setEditIndex(null);
                setTransactionType('expense');
                setAmount('');
                setCategory('');
                setDate(new Date().toISOString().slice(0, 10));
                setTransactionMonth(MONTHS[new Date().getMonth()]);
                setTransactionCard('');
                setSavingAccount('');
              }}
              className="bg-indigo-600 text-white px-4 py-2 rounded mb-6"
            >
              + Add Expense
            </button>
            {/* Transaction Form */}
            {showTransactionForm && (
              <div className="bg-white p-4 rounded-lg shadow mb-6">
                <h2 className="text-lg font-semibold mb-4">{editIndex !== null ? "Edit Expense" : "Add New Expense"}</h2>
                <form className="flex space-x-4" onSubmit={handleAddOrEditTransaction}>
                  <select
                    value={transactionMonth}
                    onChange={e => setTransactionMonth(e.target.value)}
                    className="border p-2 rounded"
                  >
                    {MONTHS.map(m => <option key={m} value={m}>{m}</option>)}
                  </select>
                  <input
                    type="number"
                    placeholder="Amount"
                    value={amount}
                    onChange={(e) => setAmount(e.target.value)}
                    className="border p-2 rounded"
                    required
                  />
                  <input
                    type="text"
                    placeholder="Category"
                    value={category}
                    onChange={(e) => setCategory(e.target.value)}
                    className="border p-2 rounded"
                    required
                  />
                  <input
                    type="date"
                    value={date}
                    onChange={(e) => setDate(e.target.value)}
                    className="border p-2 rounded"
                    required
                  />
                  <select
                    value={transactionType}
                    onChange={(e) => setTransactionType(e.target.value)}
                    className="border p-2 rounded"
                  >
                    <option value="income">Income</option>
                    <option value="expense">Expense</option>
                    <option value="saving">Saving</option>
                  </select>
                  <select
                    value={transactionCard}
                    onChange={e => setTransactionCard(e.target.value)}
                    className="border p-2 rounded"
                  >
                    <option value="">No Credit Card</option>
                    {creditCards.map((c, idx) => (
                      <option key={idx} value={c.name}>{c.name}</option>
                    ))}
                  </select>
                  {transactionType === "saving" && (
                    <input
                      type="text"
                      placeholder="Savings Account"
                      value={savingAccount}
                      onChange={e => setSavingAccount(e.target.value)}
                      className="border p-2 rounded"
                      required
                    />
                  )}
                  <button
                    type="submit"
                    className="bg-indigo-600 text-white px-4 py-2 rounded"
                  >
                    {editIndex !== null ? "Update" : "Submit"}
                  </button>
                  <button
                    type="button"
                    onClick={() => {
                      setShowTransactionForm(false);
                      setEditIndex(null);
                      setAmount('');
                      setCategory('');
                      setDate(new Date().toISOString().slice(0, 10));
                      setTransactionMonth(MONTHS[new Date().getMonth()]);
                      setTransactionCard('');
                      setSavingAccount('');
                    }}
                    className="bg-gray-300 px-4 py-2 rounded"
                  >
                    Cancel
                  </button>
                </form>
              </div>
            )}
            {/* Transaction History */}
            <div className="bg-white p-4 rounded-lg shadow">
              <h2 className="text-lg font-semibold mb-4">Transaction History</h2>
              {transactions.length === 0 ? (
                <p className="text-gray-500">No transactions yet.</p>
              ) : (
                <table className="min-w-full text-sm">
                  <thead>
                    <tr>
                      <th className="px-2 py-1 border">Date</th>
                      <th className="px-2 py-1 border">Month</th>
                      <th className="px-2 py-1 border">Type</th>
                      <th className="px-2 py-1 border">Amount</th>
                      <th className="px-2 py-1 border">Category</th>
                      <th className="px-2 py-1 border">Credit Card</th>
                      <th className="px-2 py-1 border">Savings Account</th>
                      <th className="px-2 py-1 border">Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    {transactions.map((t, idx) => (
                      <tr key={idx}>
                        <td className="px-2 py-1 border">{t.date}</td>
                        <td className="px-2 py-1 border">{t.month}</td>
                        <td className="px-2 py-1 border">{t.type}</td>
                        <td className="px-2 py-1 border">‚Ç±{parseFloat(t.amount).toFixed(2)}</td>
                        <td className="px-2 py-1 border">{t.category}</td>
                        <td className="px-2 py-1 border">{t.card || '-'}</td>
                        <td className="px-2 py-1 border">{t.account || '-'}</td>
                        <td className="px-2 py-1 border">
                          <button
                            className="text-indigo-600 underline mr-2"
                            onClick={() => handleEditTransaction(idx)}
                          >
                            Edit
                          </button>
                          <button
                            className="text-red-600 underline"
                            onClick={() => handleDeleteTransaction(idx)}
                          >
                            Delete
                          </button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              )}
            </div>
          </div>
        );
      case "tools":
        return (
          <div>
            <h1 className="text-2xl font-bold mb-4">Financial Tools</h1>
            <p className="mb-4">Access financial tools. (Feature coming soon!)</p>
          </div>
        );
      default:
        return null;
    }
  }

  return (
    <div className="min-h-screen bg-gray-100 flex flex-col">
      {/* Top Navigation Bar */}
      <div className="w-full bg-indigo-800 text-white flex flex-col md:flex-row md:items-center md:justify-between px-4 py-3 shadow">
        <div className="text-2xl font-bold flex items-center mb-2 md:mb-0">
          <span className="mr-2">üí∞</span> FinTrack Pro
        </div>
        <nav className="flex flex-wrap gap-2">
          {sidebarLinks.map(link => (
            <a
              key={link.key}
              href="#"
              className={`px-4 py-2 rounded flex items-center transition ${
                view === link.key
                  ? "bg-indigo-900"
                  : "hover:bg-indigo-700"
              }`}
              onClick={() => handleNav(link.key)}
            >
              <span className="mr-2">{link.icon}</span> {link.label}
            </a>
          ))}
        </nav>
        <div className="flex items-center space-x-2 mt-2 md:mt-0">
          <button className="p-2">
            <span>üîî</span>
          </button>
          <button className="p-2">
            <span>‚öôÔ∏è</span>
          </button>
        </div>
      </div>
      {/* Main Content */}
      <div className="flex-1 p-6 overflow-auto">
        <div className="flex justify-end items-center mb-6">
          {/* Remove search bar for dashboard */}
          {view !== "dashboard" && (
            <input
              type="text"
              placeholder="Search..."
              className="border rounded p-2 w-1/3"
            />
          )}
        </div>
        {renderContent()}
      </div>
    </div>
  );
};

ReactDOM.render(<App />, document.getElementById('root'));
</script>
</body>
</html>